
## DO NOT EDIT THIS FILE ##
# This file is automatically generated by sc-jsonnet. To modify,
# edit snapcraft.jsonnet and run sc-jsonnet (from the snap store).
adopt-info: cawbird
apps:
  cawbird:
    command: bin/check-ld-cache $SNAP/usr/bin/cawbird
    command-chain:
    - snap/command-chain/alsa-launch
    common-id: uk.co.ibboard.cawbird.desktop
    desktop: usr/share/applications/cawbird.desktop
    extensions:
    - gnome-3-28
    plugs:
    - audio-playback
    - audio-record
    - desktop
    - desktop-legacy
    - gsettings
    - home
    - network
    - network-manager-observe
    - opengl
    - pulseaudio
    - unity7
    - wayland
    - x11
base: core18
compression: lzo
confinement: strict
description: "Cawbird is a modern and lightweight Twitter client for the GNOME 3 desktop.\
  \ It\nfeatures inline image and video preview, creation of lists and favorites,\n\
  filtering of tweets and full text search. Cawbird is able to manage multiple\nTwitter\
  \ accounts.\n\nCawbird is a fork of Corebird, which became unsupported after Twitter\
  \ disabled\nthe streaming API. Cawbird works with the new APIs and includes a few\
  \ fixes\nand modifications that have historically been patched in to IBBoard's custom\n\
  Corebird build on his personal Open Build Service account[1].\n\nDue to changes\
  \ in the Twitter API[2], Cawbird has the following limitations:\n\n- Cawbird will\
  \ update every two minutes\n- Cawbird does not get notified of the following, which\
  \ will be refreshed on restart:\n    - Unfavourite\n    - Follow/Unfollow\n    -\
  \ Block/Unblock\n    - Mute/Unmute\n    - DM deletion\n    - Some list changes\n\
  \nAll limitations are limitations imposed by Twitter and are not the fault of the\n\
  Cawbird client.\n\n[1]: https://build.opensuse.org/project/show/home:IBBoard:desktop\n\
  [2]: https://developer.twitter.com/en/docs/accounts-and-users/subscribe-account-activity/migration/introduction\n"
environment:
  FINAL_BINARY: $SNAP/usr/bin/cawbird
  GIO_EXTRA_MODULES: $SNAP/usr/lib/x86_64-linux-gnu/gio/modules
  GSETTINGS_SCHEMA_DIR: $SNAP/usr/share/glib-2.0/schemas
  LD_LIBRARY_PATH: $SNAP/gnome-platform/usr/lib/$SNAPCRAFT_ARCH_TRIPLET/alsa-lib
grade: stable
layout:
  /etc/ld.so.cache:
    bind-file: $SNAP_DATA/etc/ld.so.cache
  /usr/lib/$SNAPCRAFT_ARCH_TRIPLET/alsa-lib:
    bind: $SNAP/usr/lib/$SNAPCRAFT_ARCH_TRIPLET/alsa-lib
  /usr/lib/$SNAPCRAFT_ARCH_TRIPLET/gstreamer-1.0:
    bind: $SNAP/usr/lib/$SNAPCRAFT_ARCH_TRIPLET/gstreamer-1.0
  /usr/share/alsa:
    bind: $SNAP/usr/share/alsa
name: cawbird
parts:
  alsa-mixin:
    after: []
    build-packages:
    - libasound2-dev
    plugin: dump
    source: https://github.com/diddlesnaps/snapcraft-alsa.git
    source-subdir: snapcraft-assets
    stage-packages:
    - libasound2
    - libasound2-plugins
    - yad
  cawbird:
    after:
    - alsa-mixin
    build-packages:
    - gettext
    - libgstreamer-plugins-bad1.0-dev
    - libgstreamer-plugins-good1.0-dev
    - libgspell-1-dev
    - libgstreamer1.0-dev
    - libjson-glib-dev
    - liboauth-dev
    - librest-dev
    - libsoup2.4-dev
    - libsqlite3-dev
    - libxml2-utils
    - locales-all
    - valac
    meson-parameters:
    - -Dbuildtype=release
    - -Dprefix=/usr
    override-pull: 'snapcraftctl pull


      git checkout "$(git describe --tags --abbrev=0 --match ''v*'')"

      snapcraftctl set-version "$(git describe --tags | sed -e ''s|^v||'')"


      sed -i ''s|^Icon=.*|Icon=/usr/share/icons/hicolor/scalable/apps/uk.co.ibboard.cawbird.svg|''
      data/uk.co.ibboard.cawbird.desktop.in

      '
    parse-info:
    - usr/share/metainfo/uk.co.ibboard.cawbird.appdata.xml
    plugin: meson
    source: https://github.com/ibboard/cawbird.git
    stage:
    - -usr/lib/$SNAPCRAFT_ARCH_TRIPLET/libharfbuzz*
    - -usr/share/alsa
    - -usr/lib/$SNAPCRAFT_ARCH_TRIPLET/alsa-lib
    - -usr/lib/$SNAPCRAFT_ARCH_TRIPLET/libasound*
    stage-packages:
    - gstreamer1.0-gtk3
    - gstreamer1.0-libav
    - gstreamer1.0-plugins-bad
    - gstreamer1.0-plugins-base
    - gstreamer1.0-plugins-good
    - gstreamer1.0-pulseaudio
    - gstreamer1.0-tools
    - gstreamer1.0-vaapi
    - libgstreamer1.0-0
    - liboauth0
  cleanup:
    after:
    - alsa-mixin
    - cawbird
    - gtk-locales
    - scripts
    build-snaps:
    - gtk-common-themes
    - gnome-3-28-1804
    override-prime: "set -eux\ncd \"/snap/gtk-common-themes/current\"\nfind . -type\
      \ f,l -exec rm -f \"$SNAPCRAFT_PRIME/{}\" \"$SNAPCRAFT_PRIME/usr/{}\" \\;\n\n\
      cd \"/snap/gnome-3-28-1804/current\"\nfind . -type f,l -exec rm -f \"$SNAPCRAFT_PRIME/{}\"\
      \ \"$SNAPCRAFT_PRIME/usr/{}\" \\;\n\n\nfor CRUFT in bug lintian man; do\n  \
      \  rm -rf $SNAPCRAFT_PRIME/usr/share/$CRUFT\ndone\nfind $SNAPCRAFT_PRIME/usr/share/doc/\
      \ -type f -not -name 'copyright' -delete\nfind $SNAPCRAFT_PRIME/usr/share -type\
      \ d -empty -delete\n"
    plugin: nil
  gtk-locales:
    after:
    - alsa-mixin
    - cawbird
    - scripts
    build-packages:
    - apt
    - dpkg
    override-build: 'set -eux

      for deb in *.deb; do dpkg-deb -x $deb .; done

      find usr/share/locale-langpack -type f -not -name "gtk30*.mo" -exec rm ''{}''
      \;

      mkdir -p "$SNAPCRAFT_PART_INSTALL/usr/share"

      cp -R usr/share/locale-langpack "$SNAPCRAFT_PART_INSTALL/usr/share/"

      '
    override-pull: 'set -eux

      apt download "language-pack-gnome-*-base"

      '
    plugin: nil
    stage:
    - -usr/share/alsa
    - -usr/lib/$SNAPCRAFT_ARCH_TRIPLET/alsa-lib
    - -usr/lib/$SNAPCRAFT_ARCH_TRIPLET/libasound*
    stage-packages: []
  scripts:
    after:
    - alsa-mixin
    build-packages: []
    organize:
      build-ld-cache: bin/build-ld-cache
      check-ld-cache: bin/check-ld-cache
    plugin: dump
    source: scripts
    stage:
    - -usr/share/alsa
    - -usr/lib/$SNAPCRAFT_ARCH_TRIPLET/alsa-lib
    - -usr/lib/$SNAPCRAFT_ARCH_TRIPLET/libasound*
    stage-packages: []
slots:
  dbus-cawbird:
    bus: session
    interface: dbus
    name: uk.co.ibboard.cawbird
summary: Cawbird Twitter Client (Corebird fork)
