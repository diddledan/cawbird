
## DO NOT EDIT THIS FILE ##
# This file is automatically generated by sc-jsonnet. To modify,
# edit snapcraft.jsonnet and run sc-jsonnet (from the snap store).
adopt-info: cawbird
apps:
  cawbird:
    command: usr/bin/cawbird
    common-id: uk.co.ibboard.cawbird.desktop
    desktop: usr/share/applications/uk.co.ibboard.cawbird.desktop
    extensions:
    - gnome
    plugs:
    - audio-playback
    - gsettings
    - home
    - network
    - network-manager-observe
architectures:
- build-on: amd64
- build-on: armhf
- build-on: arm64
base: core22
compression: lzo
confinement: strict
description: "Cawbird is a modern and lightweight Twitter client for the GNOME 3 desktop.\
  \ It\nfeatures inline image and video preview, creation of lists and favorites,\n\
  filtering of tweets and full text search. Cawbird is able to manage multiple\nTwitter\
  \ accounts.\n\nCawbird is a fork of Corebird, which became unsupported after Twitter\
  \ disabled\nthe streaming API. Cawbird works with the new APIs and includes a few\
  \ fixes\nand modifications that have historically been patched in to IBBoard's custom\n\
  Corebird build on his personal Open Build Service account[1].\n\nDue to changes\
  \ in the Twitter API[2], Cawbird has the following limitations:\n\n- Cawbird will\
  \ update every two minutes\n- Cawbird does not get notified of the following, which\
  \ will be refreshed on restart:\n    - Unfavourite\n    - Follow/Unfollow\n    -\
  \ Block/Unblock\n    - Mute/Unmute\n    - DM deletion\n    - Some list changes\n\
  \nAll limitations are limitations imposed by Twitter and are not the fault of the\n\
  Cawbird client.\n\n[1]: https://build.opensuse.org/project/show/home:IBBoard:desktop\n\
  [2]: https://developer.twitter.com/en/docs/accounts-and-users/subscribe-account-activity/migration/introduction\n"
environment:
  GSETTINGS_SCHEMA_DIR: $SNAP/usr/share/glib-2.0/schemas
  GTK_USE_PORTAL: '0'
grade: stable
layout:
  /usr/lib/$SNAPCRAFT_ARCH_TRIPLET/gstreamer-1.0:
    bind: $SNAP/usr/lib/$SNAPCRAFT_ARCH_TRIPLET/gstreamer-1.0
name: cawbird
parts:
  cawbird:
    build-environment:
    - CFLAGS: -Ofast -g -pipe
    - CXXFLAGS: -Ofast -g -pipe
    build-packages:
    - gettext
    - libgstreamer1.0-dev
    - libgstreamer-plugins-bad1.0-dev
    - libgstreamer-plugins-base1.0-dev
    - libgstreamer-plugins-good1.0-dev
    - liboauth-dev
    - valac
    meson-parameters:
    - -Dbuildtype=release
    - -Dprefix=/usr
    - -Db_lto=true
    - -Db_pie=true
    - -Dconsumer_key_base64=VmY5dG9yRFcyWk93MzJEZmhVdEk5Y3NMOA==
    - -Dconsumer_secret_base64=MThCRXIxbWRESDQ2Y0podzVtVU13SGUyVGlCRXhPb3BFRHhGYlB6ZkpybG5GdXZaSjI=
    override-pull: 'craftctl default


      git checkout "$(git describe --tags --abbrev=0 --exclude ''*-flatpak'' --match
      ''v*'')"

      craftctl set version="$(git describe --tags | sed -e ''s|^v||'')"


      sed -i ''s|^Icon=.*|Icon=/usr/share/icons/hicolor/scalable/apps/uk.co.ibboard.cawbird.svg|''
      data/uk.co.ibboard.cawbird.desktop.in

      '
    parse-info:
    - usr/share/metainfo/uk.co.ibboard.cawbird.appdata.xml
    plugin: meson
    source: https://github.com/ibboard/cawbird.git
    stage:
    - -usr/lib/$SNAPCRAFT_ARCH_TRIPLET/libharfbuzz*
    stage-packages:
    - freeglut3
    - gstreamer1.0-gtk3
    - gstreamer1.0-libav
    - gstreamer1.0-plugins-bad
    - gstreamer1.0-plugins-base
    - gstreamer1.0-plugins-good
    - gstreamer1.0-plugins-ugly
    - gstreamer1.0-pulseaudio
    - gstreamer1.0-tools
    - gstreamer1.0-vaapi
    - libglu1-mesa
    - libgstreamer-plugins-bad1.0-0
    - libgstreamer-plugins-base1.0-0
    - libgstreamer-plugins-good1.0-0
    - liboauth0
  cleanup:
    after:
    - cawbird
    build-snaps:
    - gtk-common-themes
    - gnome-42-2204
    override-prime: "set -eux\ncd \"/snap/gtk-common-themes/current\"\nfind . -type\
      \ f,l -exec rm -f \"$SNAPCRAFT_PRIME/{}\" \"$SNAPCRAFT_PRIME/usr/{}\" \\;\n\n\
      cd \"/snap/gnome-42-2204/current\"\nfind . -type f,l -exec rm -f \"$SNAPCRAFT_PRIME/{}\"\
      \ \"$SNAPCRAFT_PRIME/usr/{}\" \\;\n\n\nfor CRUFT in bug lintian man; do\n  \
      \  rm -rf $SNAPCRAFT_PRIME/usr/share/$CRUFT\ndone\nfind $SNAPCRAFT_PRIME/usr/share/doc/\
      \ -type f -not -name 'copyright' -delete\nfind $SNAPCRAFT_PRIME/usr/share -type\
      \ d -empty -delete\n"
    plugin: nil
slots:
  dbus-cawbird:
    bus: session
    interface: dbus
    name: uk.co.ibboard.cawbird
summary: Cawbird Twitter Client (Corebird fork)
